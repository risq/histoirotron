--------------------------- DES round function ----------------------------
 **********    **********
 *  L(r)  *    *  R(r)  *
 **********    **********
      |            |
    .------------- |
    | |            v                           .---------------------.
    | |     .-------------.                   / Linear transformation \
    | |      \   E-Box   /                   (       32b -> 48b        )
    | |       '---------'                     \                       /
    | |            |                           '---------------------'
    | |            v                                .------------.
    | |          .....        **********           / XOR operand  \
    | |          . + .<------ *  K(r)  *          (  2x48b -> 48b  )
    | |          .....        **********           \              /
    | |            /\                               '------------'
    | |           /  \
    | |          v    v                      .-------------------------.
    | |   .------.    .------.              / Non linear transformation \
    | |    \ S1 / ...  \ S8 /              (          using SBox         )
    | |     '--'        '--'                \        8x6b -> 8x4b       /
    | |         \      /                     '-------------------------'
    | |          \    /
    | |           v  v                          .---------------------.
    | |        .--------.                      / Linear transformation \
    | |        |  P-Box |                     (       32b -> 32b        )
    | |        '--------'                      \                       /
    | |            |                            '---------------------'
    | |          ..v..                              .------------.
    | '--------->. + .                             / XOR operand  \
    |            .....                            (  2x32b -> 32b  )
    |              |                               \              /
    v              v                                '------------'
 **********    **********
 * L(r+1) *    * R(r+1) *
 **********    **********


---------------------------------------------------------------------------


                    32b               48b              16b
               ************** ********************* ********
               *     L(r)   * *       X(r)        * * r(r) *
               ************** ********************* ********
                      |               |      |         |
                      |               v      |         |
                      |   ******    .....    |         v
                      |   * sK *--> . + .    |    .-------.
                      |   ******    .....    '-->(  Merge  )
                      |               |           '-------'
                      |               v               |
                      |        .-------------.        |
                      |         \     S     /         |
                      |          '---------'          |
                      |               |               |
                32b   v               v 32b     32b   v
               ************** *************** **************
               *    L(r)    * *    Y(r+1)   * *    R(r)    *
               ************** *************** **************



               *********************************************
               *          state 1 (12 x 8 = 96 bits)       *
               *********************************************
                  |      |      |                       |
                  v      v      v                       v
               .-----..-----..-----.                 .-----.
               | T0  || T1  || T2  |       ...       | T11 |
               '-----''-----''-----'                 '-----'
                  |      |      |                       |
                  v      v      v                       v
               *********************************************
               *              state 2 (96 bits)            *
               *********************************************



              ************** *************** ***************
              *    L(r)    * *    Y(r+1)   * *     R(r)    *
              ************** *************** ***************
                    |                  |           |
                    v                  |           |
                  .....    .--------.  |           |
                  . + .<---|    P   |<-'           |
                  .....    '--------'              |
                   |                               |
               32b '----------------------------------.
                                       |           |  |
                   .-------------------|-----------'  |
                   |               32b v              v 32b
                   |               .-------.       .------.
                   |              /  E-box  \     ( Select )
                   |  32b        '-----------'     '------'
                   |                   |              |
                   v               48b v              v 16b
              ************** ********************* ********
             *   L(r+1)   * *       X(r+1)      * *r(r+1)*
              ************** ********************* ********



              *********************************************
              *              state 2 (96 bits)            *
              *********************************************
                 |      |      |                       |
                 v      v      v          ...          v

              ?????????????????????????????????????????????

                 |      |      |          ...          |
                 v      v      v                       v
              *********************************************
              *              state 3 (96 bits)            *
              *********************************************
